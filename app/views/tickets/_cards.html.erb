<div class="container-tickets">
  <div class="dashboard-stats">
    <h1 class="mt-5">Tickets dashboard</h1>
    <div class="card mt-5" style="width: 18rem;">
      <div class="card-body">
        <h5 class="card-title">Welcome on your dashboard</h5>
        <p class="card-text">Please feel free to visit each ticket, and to comment them.</p>
      </div>
      <ul class="list-group list-group-flush">
        <li class="list-group-item">Number of opened tickets : <%= @tickets.count %></li>
        <li class="list-group-item">Number of closed tickets : <%= Ticket.where(open: false).count %></li>
      </ul>
    </div>
  </div>
  <div class="progress-tickets mt-5 mb-5">
    <h3 class="status-title">📚 In Progress</h3>
    <div class="progress-results">
      <% @tickets.where(status: :in_progress).each do |ticket| %>
        <%= link_to ticket, data: {toggle: "modal", target: "#showModal#{ticket.id}"}, class: 'static-popup-link' do %>
          <div class="card mt-5" style="width: 300px;">
            <%= image_tag(ticket.photo_url, class: "card-img-top mt-3") %>
            <div class="card-body">
              <div class="card-text">
                <p class="title-card"><span class="title-desc">📌<%= ticket.title.capitalize %></span></p>
                <p><span class="created-at">Created: <%= ticket.created_at.strftime("%d of %B, %Y at %k:%M") %></span></p>
                <div class="card-bottom">
                  <p class="manager-card"><%= ticket.user.first_name %></p>
                  <p><span class="comments-count">📩<%= ticket.comments.count %></span></p>
                </div>
              </div>
            </div>
          </div>
        <% end %>
        <%= render :partial => 'modal', locals: { ticket: ticket } %>
      <% end %>
    </div>
  </div>
  <div class="review-tickets mt-5 mb-5">
    <h3 class="status-title">⚙️ In Review</h3>
    <div class="reviews-results">
      <% @tickets.where(status: :in_review).each do |ticket| %>
        <%= link_to ticket, data: {toggle: "modal", target: "#showModal#{ticket.id}"}, class: 'static-popup-link' do %>
          <div class="card mt-5" style="width: 300px;">
            <%= image_tag(ticket.photo_url, class: "card-img-top mt-3") %>
            <div class="card-body">
              <div class="card-text">
                <p class="title-card"><span class="title-desc">🗒 <%= ticket.title.capitalize %></span></p>
                <p><span class="created-at">Created: <%= ticket.created_at.strftime("%d of %B, %Y at %k:%M") %></span></p>
                <div class="card-bottom">
                  <p class="manager-card"><%= ticket.user.first_name %></p>
                  <p><span class="comments-count">📩<%= ticket.comments.count %></span></p>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      <%= render :partial => 'modal', locals: { ticket: ticket } %>
      <% end %>
    </div>
  </div>
  <div class="completed-tickets mt-5 mb-5">
    <h3 class="status-title">🙌 Completed</h3>
    <div class="completed-results">
      <% @tickets.where(status: :completed).each do |ticket| %>
        <%= link_to ticket, data: {toggle: "modal", target: "#showModal#{ticket.id}"}, class: 'static-popup-link' do %>
          <div class="card mt-5" style="width: 300px;">
            <%= image_tag(ticket.photo_url, class: "card-img-top mt-3") %>
            <div class="card-body">
              <div class="card-text">
                <p class="title-card"><span class="title-desc">🖥<%= ticket.title.capitalize %></span></p>
                <p><span class="created-at">Created: <%= ticket.created_at.strftime("%d of %B, %Y at %k:%M") %></span></p>
                <div class="card-bottom">
                  <p class="manager-card"><%= ticket.user.first_name %></p>
                  <p><span class="comments-count">📩<%= ticket.comments.count %></span></p>
                </div>
              </div>
            </div>
          </div>
        <% end %>
        <%= render :partial => 'modal', locals: { ticket: ticket } %>
      <% end %>
    </div>
  </div>
</div>
